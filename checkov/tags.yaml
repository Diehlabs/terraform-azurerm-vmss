---
metadata:
  name: "Check that all resources are tagged with the key - environment"
  id: "TAGS_0001"
  category: "GENERAL_SECURITY"

scope:
  provider: azurerm

definition:
  cond_type: "attribute"
  resource_types:
    - "azurerm_network_security_group"
    - "azurerm_virtual_network"
    - "azurerm_resource_group"
    - "azurerm_linux_virtual_machine_scale_set"
  attribute: "tags.environment"
  operator: "exists"
